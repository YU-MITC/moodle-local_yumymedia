function _typeof(a){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("local_yumymedia/accessrestriction",["jquery"],function(a){return{init:function init(){var l={ENTRY_ERROR_IMPORTING:-2,ENTRY_ERROR_CONVERTING:-1,ENTRY_IMPORT:0,ENTRY_PRECONVERT:1,ENTRY_READY:2,ENTRY_DELETED:3,ENTRY_PENDING:4,ENTRY_MODERATE:5,ENTRY_BLOCKED:6,ENTRY_NO_CONTENT:7};function b(){var b=a(window).width(),c=a(window).height(),d=a("#modal_content").outerWidth(),e=a("#modal_content").outerHeight();a("#modal_content").css({left:(b-d)/2+"px",top:(c-e)/2+"px"})}function c(){a(this).blur();if(a("#modal_window")[0]){return!1}a("body").append("<div id=\"modal_window\"></div>");a("#modal_window").fadeIn("slow");b();a("#modal_content").fadeIn("slow");return!0}function d(a){location.href=a}function e(b){a("#modal_content").append("<input type=button id=\"backToMymedia\" name=\"backToMymedia\" value=Back />");a("#backToMyMedia").on("click",function(){d(b)})}function f(){require(["core/str","core/notification"],function(b,c){b.get_strings([{key:"heading_access_control",component:"local_yumymedia"},{key:"accesscontrol_changed",component:"local_yumymedia"}]).then(function(b){var c=a("#access_control_select").val(),d=a("#currentcontrol").val(),e=b[0];if(c!=d){e=e+" <font color=\"red\">("+b[1]+")</font>";a("#access_media_save").prop("disabled",!1)}else{a("#access_media_save").prop("disabled",!0)}a("#access_control_label").html(e);return 0}).fail(c.exception)})}function g(){var b,c,d=a("#access_control_select").val(),e=a("#entryid").val(),f=a("#kalturahost").val(),g=a("#ks").val(),j=new FormData;j.append("action","update");j.append("ks",g);j.append("entryId",e);j.append("baseEntry:accessControlId",d);a.ajax(f+"/api_v3/service/baseEntry/action/update",{type:"POST",data:j,cache:!1,async:!0,contentType:!1,scriptCharset:"utf-8",processData:!1,dataType:"xml"}).done(function(e){if(null===e||_typeof(e)===void 0){i("Update failed (Cannot get a XML response)");return}c=a(e).find("code");if(null!==c&&_typeof(c)!==void 0&&""!==c.text()){i("Update failed ("+c.text()+")");return}c=a(e).find("status");if(null===c||_typeof(c)===void 0||""===c.text()){i("Update failed (Cannot get a baseEntry)");return}b=c.text();if(b!=l.ENTRY_READY&&b!=l.ENTRY_PENDING&&b!=l.ENTRY_PRECONVERT){i("Update failed (status of baseEntry: "+b+")");return}c=a(e).find("accessControlId");if(null===c||_typeof(c)===void 0||""===c.text()){i("Update failed(Cannot get an accessControlId)");return}var f=c.text();if(f!=d){i("Update failed(accessControlId: "+f+")");return}h(f)}).fail(function(a){if(null!==a){window.console.dir(a)}i("Update fialed(Cannot connect to contents server)")})}function h(b){require(["core/str","core/notification"],function(d,f){d.get_strings([{key:"accesscontrol_updated",component:"local_yumymedia"}]).then(function(d){var f=a("#mymedia").val();a("#access_media_save").prop("disabled",!0);a("#currentcontrol").val(b);c();a("#modal_content").append("<p>"+d[0]+"</p><br>");e(f);j();setTimeout(function(){window.location.replace(f)},1e3);return 0}).fail(f.exception)})}function i(b){var d=a("#mymedia").val();b="<p><font color=red>"+b+"</font></p><br>";c();a("#modal_content").append(b);e(d);j()}function j(){var b=a("#kalturahost").val();a.ajax({type:"GET",url:b+"/api_v3/service/session/action/end",cache:!1}).done(function(a){if(null!==a){window.console.dir(a)}}).fail(function(a){if(null!==a){window.console.dir(a)}})}function k(){var b=a("#code_type_select").val(),c=a("#kalturahost").val(),d=a("#partnerid").val(),e=a("#uiconfid").val(),f=a("#entryid").val(),g=Date.now(),h="";if("0"==b){h="<iframe src=\""+c+"/p/"+d+"/sp/"+d+"00";h+="/embedIframeJs/uiconf_id/"+e+"/partner_id/"+d;h+="?iframeembed=true&playerId=kaltura_player_"+g;h+="&entry_id="+f+"\" width=\"560\" height=\"395\" ";h+="allowfullscreen webkitallowfullscreen mozAllowFullScreen frameborder=\"0\" ";h+="allow=\"encrypted-media\"></iframe>"}else{h=c+"/index.php/extwidget/preview/partner_id/";h+=d+"/uiconf_id/"+e+"/entry_id/"+f+"/embed/dynamic?"}a("#codearea").val(h)}a(window).on("unload",function(){j()});a(window).resize(b);a("#access_control_select").on("change",function(){f()});a("#code_type_select").on("change",function(){k()});a("#access_media_save").on("click",function(){g()});k()}}});
//# sourceMappingURL=accessrestriction.min.js.map
