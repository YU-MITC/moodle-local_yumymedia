define(["jquery"],function(a){return{init:function(){function b(){var b=a(window).width(),c=a(window).height(),d=a("#modal_content").outerWidth(),e=a("#modal_content").outerHeight();a("#modal_content").css({left:(b-d)/2+"px",top:(c-e)/2+"px"})}function c(){return a(this).blur(),a("#modal_window")[0]?!1:(a("body").append('<div id="modal_window"></div>'),a("#modal_window").fadeIn("slow"),b(),a("#modal_content").fadeIn("slow"),!0)}function d(a){location.href=a}function e(b){var c='<input type=button id="backToMymedia" name="backToMymedia" value=Back />';a("#modal_content").append(c),a("#backToMyMedia").on("click",function(){d(b)})}function f(){require(["core/str"],function(b){var c=[{key:"heading_access_control",component:"local_yumymedia"},{key:"accesscontrol_changed",component:"local_yumymedia"}];return b.get_strings(c).then(function(b){var c=a("#access_control_select").val(),d=a("#currentcontrol").val(),e=b[0];return c!=d?(e=e+' <font color="red">('+b[1]+")</font>",a("#access_media_save").prop("disabled",!1)):a("#access_media_save").prop("disabled",!0),a("#access_control_label").html(e),0}),0})}function g(){var b,c,d=a("#access_control_select").val(),e=a("#entryid").val(),f=a("#kalturahost").val(),g=a("#ks").val(),j=new FormData;j.append("action","update"),j.append("ks",g),j.append("entryId",e),j.append("baseEntry:accessControlId",d);var k={type:"POST",data:j,cache:!1,async:!0,contentType:!1,scriptCharset:"utf-8",processData:!1,dataType:"xml"},m=f+"/api_v3/service/baseEntry/action/update";a.ajax(m,k).done(function(e){if(null===e||void 0===typeof e)return void i("Update failed (Cannot get a XML response)");if(c=a(e).find("code"),null!==c&&void 0!==typeof c&&""!==c.text())return void i("Update failed ("+c.text()+")");if(c=a(e).find("status"),null===c||void 0===typeof c||""===c.text())return void i("Update failed (Cannot get a baseEntry)");if(b=c.text(),b!=l.ENTRY_READY&&b!=l.ENTRY_PENDING&&b!=l.ENTRY_PRECONVERT)return void i("Update failed (status of baseEntry: "+b+")");if(c=a(e).find("accessControlId"),null===c||void 0===typeof c||""===c.text())return void i("Update failed(Cannot get an accessControlId)");var f=c.text();return f!=d?void i("Update failed(accessControlId: "+f+")"):void h(f)}).fail(function(a){null!==a&&window.console.dir(a),i("Update fialed(Cannot connect to contents server)")})}function h(b){require(["core/str"],function(d){var f=[{key:"accesscontrol_updated",component:"local_yumymedia"}];return d.get_strings(f).then(function(d){var f=a("#mymedia").val();return a("#access_media_save").prop("disabled",!0),a("#currentcontrol").val(b),c(),a("#modal_content").append("<p>"+d[0]+"</p><br>"),e(f),j(),setTimeout(function(){window.location.replace(f)},1e3),0}),0})}function i(b){var d=a("#mymedia").val();b="<p><font color=red>"+b+"</font></p><br>",c(),a("#modal_content").append(b),e(d),j()}function j(){var b=a("#kalturahost").val(),c=b+"/api_v3/service/session/action/end";a.ajax({type:"GET",url:c,cache:!1}).done(function(a){null!==a&&window.console.dir(a)}).fail(function(a){null!==a&&window.console.dir(a)})}function k(){var b=a("#code_type_select").val(),c=a("#kalturahost").val(),d=a("#partnerid").val(),e=a("#uiconfid").val(),f=a("#entryid").val(),g=Date.now(),h="";"0"==b?(h='<iframe src="'+c+"/p/"+d+"/sp/"+d+"00",h+="/embedIframeJs/uiconf_id/"+e+"/partner_id/"+d,h+="?iframeembed=true&playerId=kaltura_player_"+g,h+="&entry_id="+f+'" width="560" height="395" ',h+='allowfullscreen webkitallowfullscreen mozAllowFullScreen frameborder="0" ',h+='allow="encrypted-media"></iframe>'):(h=c+"/index.php/extwidget/preview/partner_id/",h+=d+"/uiconf_id/"+e+"/entry_id/"+f+"/embed/dynamic?"),a("#codearea").val(h)}var l={ENTRY_ERROR_IMPORTING:-2,ENTRY_ERROR_CONVERTING:-1,ENTRY_IMPORT:0,ENTRY_PRECONVERT:1,ENTRY_READY:2,ENTRY_DELETED:3,ENTRY_PENDING:4,ENTRY_MODERATE:5,ENTRY_BLOCKED:6,ENTRY_NO_CONTENT:7};a(window).on("unload",function(){j()}),a(window).resize(b),a("#access_control_select").on("change",function(){f()}),a("#code_type_select").on("change",function(){k()}),a("#access_media_save").on("click",function(){g()}),k()}}});