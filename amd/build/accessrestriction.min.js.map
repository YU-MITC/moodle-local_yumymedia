{"version":3,"sources":["../src/accessrestriction.js"],"names":["define","$","init","STATUS","ENTRY_ERROR_IMPORTING","ENTRY_ERROR_CONVERTING","ENTRY_IMPORT","ENTRY_PRECONVERT","ENTRY_READY","ENTRY_DELETED","ENTRY_PENDING","ENTRY_MODERATE","ENTRY_BLOCKED","ENTRY_NO_CONTENT","centeringModalSyncer","w","window","width","h","height","cw","outerWidth","ch","outerHeight","css","fadeInModalWindow","blur","append","fadeIn","handleCancelClick","url","location","href","addBackButton","on","selectedControl","require","str","notification","get_strings","key","component","then","results","selectedControlId","val","currentControlId","newLabel","prop","html","fail","exception","updateAccessControlId","entryStatus","findData","controlId","entryId","serverHost","ks","fd","FormData","ajax","type","data","cache","async","contentType","scriptCharset","processData","dataType","done","xmlData","printErrorMessage","find","text","resultId","printSuccessMessage","console","dir","currentControl","mymedia","sessionEnd","setTimeout","replace","message","printHtmlCode","selectedId","kalturaHost","partnerId","uiconfId","now","Date","resize"],"mappings":"yQA2BAA,OAAM,qCAAC,CAAC,QAAD,CAAD,CAAa,SAASC,CAAT,CAAY,CAE3B,MAAO,CAKHC,IAAI,CAAE,eAAW,CAEb,GAAIC,CAAAA,CAAM,CAAG,CACTC,qBAAqB,CAAE,CAAC,CADf,CAETC,sBAAsB,CAAE,CAAC,CAFhB,CAGTC,YAAY,CAAE,CAHL,CAITC,gBAAgB,CAAE,CAJT,CAKTC,WAAW,CAAE,CALJ,CAMTC,aAAa,CAAE,CANN,CAOTC,aAAa,CAAE,CAPN,CAQTC,cAAc,CAAE,CARP,CASTC,aAAa,CAAE,CATN,CAUTC,gBAAgB,CAAE,CAVT,CAAb,CAgBA,QAASC,CAAAA,CAAT,EAAgC,IAGxBC,CAAAA,CAAC,CAAGd,CAAC,CAACe,MAAD,CAAD,CAAUC,KAAV,EAHoB,CAIxBC,CAAC,CAAGjB,CAAC,CAACe,MAAD,CAAD,CAAUG,MAAV,EAJoB,CAOxBC,CAAE,CAAGnB,CAAC,CAAC,gBAAD,CAAD,CAAoBoB,UAApB,EAPmB,CAQxBC,CAAE,CAAGrB,CAAC,CAAC,gBAAD,CAAD,CAAoBsB,WAApB,EARmB,CAW5BtB,CAAC,CAAC,gBAAD,CAAD,CAAoBuB,GAApB,CAAwB,CAAC,KAAS,CAACT,CAAC,CAAGK,CAAL,EAAW,CAAZ,CAAiB,IAA1B,CAAgC,IAAQ,CAACF,CAAC,CAAGI,CAAL,EAAW,CAAZ,CAAiB,IAAxD,CAAxB,CACH,CAMD,QAASG,CAAAA,CAAT,EAA6B,CAEzBxB,CAAC,CAAC,IAAD,CAAD,CAAQyB,IAAR,GAEA,GAAIzB,CAAC,CAAC,eAAD,CAAD,CAAmB,CAAnB,CAAJ,CAA2B,CACvB,QACH,CAGDA,CAAC,CAAC,MAAD,CAAD,CAAU0B,MAAV,CAAiB,iCAAjB,EACA1B,CAAC,CAAC,eAAD,CAAD,CAAmB2B,MAAnB,CAA0B,MAA1B,EAGAd,CAAoB,GAEpBb,CAAC,CAAC,gBAAD,CAAD,CAAoB2B,MAApB,CAA2B,MAA3B,EACA,QACH,CAMD,QAASC,CAAAA,CAAT,CAA2BC,CAA3B,CAAgC,CAC5BC,QAAQ,CAACC,IAAT,CAAgBF,CACnB,CAMD,QAASG,CAAAA,CAAT,CAAuBH,CAAvB,CAA4B,CAExB7B,CAAC,CAAC,gBAAD,CAAD,CAAoB0B,MAApB,iFACA1B,CAAC,CAAC,gBAAD,CAAD,CAAoBiC,EAApB,CAAuB,OAAvB,CAAgC,UAAW,CACvCL,CAAiB,CAACC,CAAD,CACpB,CAFD,CAGH,CAKD,QAASK,CAAAA,CAAT,EAA2B,CACvBC,OAAO,CAAC,CAAC,UAAD,CAAa,mBAAb,CAAD,CAAoC,SAASC,CAAT,CAAcC,CAAd,CAA4B,CAKnED,CAAG,CAACE,WAAJ,CAJc,CACV,CAACC,GAAG,CAAE,wBAAN,CAAgCC,SAAS,CAAE,iBAA3C,CADU,CAEV,CAACD,GAAG,CAAE,uBAAN,CAA+BC,SAAS,CAAE,iBAA1C,CAFU,CAId,EAAyBC,IAAzB,CAA8B,SAASC,CAAT,CAAkB,IACxCC,CAAAA,CAAiB,CAAG3C,CAAC,CAAC,wBAAD,CAAD,CAA4B4C,GAA5B,EADoB,CAExCC,CAAgB,CAAG7C,CAAC,CAAC,iBAAD,CAAD,CAAqB4C,GAArB,EAFqB,CAIxCE,CAAQ,CAAGJ,CAAO,CAAC,CAAD,CAJsB,CAM5C,GAAIC,CAAiB,EAAIE,CAAzB,CAA2C,CACvCC,CAAQ,CAAGA,CAAQ,CAAG,wBAAX,CAAsCJ,CAAO,CAAC,CAAD,CAA7C,CAAmD,UAA9D,CACA1C,CAAC,CAAC,oBAAD,CAAD,CAAwB+C,IAAxB,CAA6B,UAA7B,IACH,CAHD,IAGO,CACH/C,CAAC,CAAC,oBAAD,CAAD,CAAwB+C,IAAxB,CAA6B,UAA7B,IACH,CAED/C,CAAC,CAAC,uBAAD,CAAD,CAA2BgD,IAA3B,CAAgCF,CAAhC,EACA,MAAO,EACV,CAfD,EAeGG,IAfH,CAeQZ,CAAY,CAACa,SAfrB,CAgBH,CArBM,CAsBV,CAKD,QAASC,CAAAA,CAAT,EAAiC,IACzBC,CAAAA,CADyB,CAEzBC,CAFyB,CAIzBC,CAAS,CAAGtD,CAAC,CAAC,wBAAD,CAAD,CAA4B4C,GAA5B,EAJa,CAKzBW,CAAO,CAAGvD,CAAC,CAAC,UAAD,CAAD,CAAc4C,GAAd,EALe,CAMzBY,CAAU,CAAGxD,CAAC,CAAC,cAAD,CAAD,CAAkB4C,GAAlB,EANY,CAOzBa,CAAE,CAAGzD,CAAC,CAAC,KAAD,CAAD,CAAS4C,GAAT,EAPoB,CAUzBc,CAAE,CAAG,GAAIC,CAAAA,QAVgB,CAW7BD,CAAE,CAAChC,MAAH,CAAU,QAAV,CAAoB,QAApB,EACAgC,CAAE,CAAChC,MAAH,CAAU,IAAV,CAAgB+B,CAAhB,EACAC,CAAE,CAAChC,MAAH,CAAU,SAAV,CAAqB6B,CAArB,EACAG,CAAE,CAAChC,MAAH,CAAU,2BAAV,CAAuC4B,CAAvC,EAiBAtD,CAAC,CAAC4D,IAAF,CAHiBJ,CAAU,CAAG,yCAG9B,CAde,CACXK,IAAI,CAAE,MADK,CAEXC,IAAI,CAAEJ,CAFK,CAGXK,KAAK,GAHM,CAIXC,KAAK,GAJM,CAKXC,WAAW,GALA,CAMXC,aAAa,CAAE,OANJ,CAOXC,WAAW,GAPA,CAQXC,QAAQ,CAAE,KARC,CAcf,EAGCC,IAHD,CAGM,SAASC,CAAT,CAAkB,CAEpB,GAAgB,IAAZ,GAAAA,CAAO,EAAa,QAAOA,CAAP,UAAxB,CAAsD,CAClDC,CAAiB,CAAC,2CAAD,CAAjB,CACA,MACH,CAGDlB,CAAQ,CAAGrD,CAAC,CAACsE,CAAD,CAAD,CAAWE,IAAX,CAAgB,MAAhB,CAAX,CAEA,GAAiB,IAAb,GAAAnB,CAAQ,EAAa,QAAOA,CAAP,UAArB,EAA0E,EAApB,GAAAA,CAAQ,CAACoB,IAAT,EAA1D,CAAkF,CAC9EF,CAAiB,CAAC,kBAAoBlB,CAAQ,CAACoB,IAAT,EAApB,CAAsC,GAAvC,CAAjB,CACA,MACH,CAGDpB,CAAQ,CAAGrD,CAAC,CAACsE,CAAD,CAAD,CAAWE,IAAX,CAAgB,QAAhB,CAAX,CAEA,GAAiB,IAAb,GAAAnB,CAAQ,EAAa,QAAOA,CAAP,UAArB,EAA0E,EAApB,GAAAA,CAAQ,CAACoB,IAAT,EAA1D,CAAkF,CAC9EF,CAAiB,CAAC,wCAAD,CAAjB,CACA,MACH,CAGDnB,CAAW,CAAGC,CAAQ,CAACoB,IAAT,EAAd,CAEA,GAAIrB,CAAW,EAAIlD,CAAM,CAACK,WAAtB,EAAqC6C,CAAW,EAAIlD,CAAM,CAACO,aAA3D,EACA2C,CAAW,EAAIlD,CAAM,CAACI,gBAD1B,CAC4C,CACxCiE,CAAiB,CAAC,uCAAyCnB,CAAzC,CAAuD,GAAxD,CAAjB,CACA,MACH,CAGDC,CAAQ,CAAGrD,CAAC,CAACsE,CAAD,CAAD,CAAWE,IAAX,CAAgB,iBAAhB,CAAX,CAEA,GAAiB,IAAb,GAAAnB,CAAQ,EAAa,QAAOA,CAAP,UAArB,EAA0E,EAApB,GAAAA,CAAQ,CAACoB,IAAT,EAA1D,CAAkF,CAC9EF,CAAiB,CAAC,8CAAD,CAAjB,CACA,MACH,CAGD,GAAIG,CAAAA,CAAQ,CAAGrB,CAAQ,CAACoB,IAAT,EAAf,CAEA,GAAIC,CAAQ,EAAIpB,CAAhB,CAA2B,CACvBiB,CAAiB,CAAC,kCAAoCG,CAApC,CAA+C,GAAhD,CAAjB,CACA,MACH,CAGDC,CAAmB,CAACD,CAAD,CACtB,CArDD,EAsDCzB,IAtDD,CAsDM,SAASqB,CAAT,CAAkB,CACpB,GAAgB,IAAZ,GAAAA,CAAJ,CAAsB,CAClBvD,MAAM,CAAC6D,OAAP,CAAeC,GAAf,CAAmBP,CAAnB,CACH,CACDC,CAAiB,CAAC,kDAAD,CAEpB,CA5DD,CA6DH,CAMD,QAASI,CAAAA,CAAT,CAA6BG,CAA7B,CAA6C,CACzC3C,OAAO,CAAC,CAAC,UAAD,CAAa,mBAAb,CAAD,CAAoC,SAASC,CAAT,CAAcC,CAAd,CAA4B,CAInED,CAAG,CAACE,WAAJ,CAHc,CACV,CAACC,GAAG,CAAE,uBAAN,CAA+BC,SAAS,CAAE,iBAA1C,CADU,CAGd,EAAyBC,IAAzB,CAA8B,SAASC,CAAT,CAAkB,CAC5C,GAAIqC,CAAAA,CAAO,CAAG/E,CAAC,CAAC,UAAD,CAAD,CAAc4C,GAAd,EAAd,CACA5C,CAAC,CAAC,oBAAD,CAAD,CAAwB+C,IAAxB,CAA6B,UAA7B,KACA/C,CAAC,CAAC,iBAAD,CAAD,CAAqB4C,GAArB,CAAyBkC,CAAzB,EAGAtD,CAAiB,GAEjBxB,CAAC,CAAC,gBAAD,CAAD,CAAoB0B,MAApB,CAA2B,MAAQgB,CAAO,CAAC,CAAD,CAAf,CAAqB,UAAhD,EAEAV,CAAa,CAAC+C,CAAD,CAAb,CAEAC,CAAU,GAEVC,UAAU,CAAC,UAAW,CAClBlE,MAAM,CAACe,QAAP,CAAgBoD,OAAhB,CAAwBH,CAAxB,CACH,CAFS,CAEP,GAFO,CAAV,CAGA,MAAO,EACV,CAlBD,EAkBG9B,IAlBH,CAkBQZ,CAAY,CAACa,SAlBrB,CAmBH,CAvBM,CAwBV,CAMD,QAASqB,CAAAA,CAAT,CAA2BY,CAA3B,CAAoC,CAChC,GAAIJ,CAAAA,CAAO,CAAG/E,CAAC,CAAC,UAAD,CAAD,CAAc4C,GAAd,EAAd,CAGAuC,CAAO,CAAG,sBAAwBA,CAAxB,CAAkC,iBAA5C,CAEA3D,CAAiB,GAEjBxB,CAAC,CAAC,gBAAD,CAAD,CAAoB0B,MAApB,CAA2ByD,CAA3B,EAEAnD,CAAa,CAAC+C,CAAD,CAAb,CAEAC,CAAU,EACb,CAKD,QAASA,CAAAA,CAAT,EAAsB,IACdxB,CAAAA,CAAU,CAAGxD,CAAC,CAAC,cAAD,CAAD,CAAkB4C,GAAlB,EADC,CAKlB5C,CAAC,CAAC4D,IAAF,CAAO,CACHC,IAAI,CAAE,KADH,CAEHhC,GAAG,CALU2B,CAAU,CAAG,oCAGvB,CAGHO,KAAK,GAHF,CAAP,EAKCM,IALD,CAKM,SAASC,CAAT,CAAkB,CAEpB,GAAgB,IAAZ,GAAAA,CAAJ,CAAsB,CAClBvD,MAAM,CAAC6D,OAAP,CAAeC,GAAf,CAAmBP,CAAnB,CACH,CACJ,CAVD,EAWCrB,IAXD,CAWM,SAASqB,CAAT,CAAkB,CACpB,GAAgB,IAAZ,GAAAA,CAAJ,CAAsB,CAClBvD,MAAM,CAAC6D,OAAP,CAAeC,GAAf,CAAmBP,CAAnB,CACH,CACJ,CAfD,CAgBH,CAKD,QAASc,CAAAA,CAAT,EAAyB,IACjBC,CAAAA,CAAU,CAAGrF,CAAC,CAAC,mBAAD,CAAD,CAAuB4C,GAAvB,EADI,CAEjB0C,CAAW,CAAGtF,CAAC,CAAC,cAAD,CAAD,CAAkB4C,GAAlB,EAFG,CAGjB2C,CAAS,CAAGvF,CAAC,CAAC,YAAD,CAAD,CAAgB4C,GAAhB,EAHK,CAIjB4C,CAAQ,CAAGxF,CAAC,CAAC,WAAD,CAAD,CAAe4C,GAAf,EAJM,CAKjBW,CAAO,CAAGvD,CAAC,CAAC,UAAD,CAAD,CAAc4C,GAAd,EALO,CAMjB6C,CAAG,CAAGC,IAAI,CAACD,GAAL,EANW,CAOjBrD,CAAG,CAAG,EAPW,CASrB,GAAkB,GAAd,EAAAiD,CAAJ,CAAuB,CACnBjD,CAAG,CAAG,iBAAmBkD,CAAnB,CAAiC,KAAjC,CAAyCC,CAAzC,CAAqD,MAArD,CAA8DA,CAA9D,CAA0E,IAAhF,CACAnD,CAAG,EAAI,4BAA8BoD,CAA9B,CAAyC,cAAzC,CAA0DD,CAAjE,CACAnD,CAAG,EAAI,6CAA+CqD,CAAtD,CACArD,CAAG,EAAI,aAAemB,CAAf,CAAyB,kCAAhC,CACAnB,CAAG,EAAI,6EAAP,CACAA,CAAG,EAAI,qCACV,CAPD,IAOO,CACHA,CAAG,CAAGkD,CAAW,CAAG,0CAApB,CACAlD,CAAG,EAAImD,CAAS,CAAG,aAAZ,CAA4BC,CAA5B,CAAuC,YAAvC,CAAsDjC,CAAtD,CAAgE,iBAC1E,CACDvD,CAAC,CAAC,WAAD,CAAD,CAAe4C,GAAf,CAAmBR,CAAnB,CACH,CAGDpC,CAAC,CAACe,MAAD,CAAD,CAAUkB,EAAV,CAAa,QAAb,CAAuB,UAAW,CAC9B+C,CAAU,EACb,CAFD,EAKAhF,CAAC,CAACe,MAAD,CAAD,CAAU4E,MAAV,CAAiB9E,CAAjB,EAGAb,CAAC,CAAC,wBAAD,CAAD,CAA4BiC,EAA5B,CAA+B,QAA/B,CAAyC,UAAW,CAChDC,CAAe,EAClB,CAFD,EAKAlC,CAAC,CAAC,mBAAD,CAAD,CAAuBiC,EAAvB,CAA0B,QAA1B,CAAoC,UAAW,CAC3CmD,CAAa,EAChB,CAFD,EAKApF,CAAC,CAAC,oBAAD,CAAD,CAAwBiC,EAAxB,CAA2B,OAA3B,CAAoC,UAAW,CAC3CkB,CAAqB,EACxB,CAFD,EAIAiC,CAAa,EAChB,CA3UE,CA6UV,CA/UK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * YU Kaltura \"My Media\" script for acecss restriction setting.\n *\n * @package    local_yumymedia\n * @copyright  (C) 2016-2020 Yamaguchi University (gh-cc@mlex.cc.yamaguchi-u.ac.jp)\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module local_yumymedia/accessrestriction\n */\n\ndefine(['jquery'], function($) {\n\n    return {\n        /**\n         * Initial function.\n         * @access public\n         */\n        init: function() {\n\n            var STATUS = {\n                ENTRY_ERROR_IMPORTING: -2,\n                ENTRY_ERROR_CONVERTING: -1,\n                ENTRY_IMPORT: 0,\n                ENTRY_PRECONVERT: 1,\n                ENTRY_READY: 2,\n                ENTRY_DELETED: 3,\n                ENTRY_PENDING: 4,\n                ENTRY_MODERATE: 5,\n                ENTRY_BLOCKED: 6,\n                ENTRY_NO_CONTENT: 7\n            };\n\n            /**\n             * This function centerize modal window.\n             */\n            function centeringModalSyncer() {\n\n                // Get width and height of window.\n                var w = $(window).width();\n                var h = $(window).height();\n\n                // Get width and height of content area.\n                var cw = $(\"#modal_content\").outerWidth();\n                var ch = $(\"#modal_content\").outerHeight();\n\n                // Execute centering.\n                $(\"#modal_content\").css({\"left\": ((w - cw) / 2) + \"px\", \"top\": ((h - ch) / 2) + \"px\"});\n            }\n\n            /**\n             * This function print modal window.\n             * @return {bool} - If modal window open, return true. Otherwise return false.\n             */\n            function fadeInModalWindow() {\n                // All contents in web page release focus.\n                $(this).blur();\n                // Precent dupulicate execute of modal window.\n                if ($(\"#modal_window\")[0]) {\n                    return false;\n                }\n\n                // Create modal window and a content area.\n                $(\"body\").append(\"<div id=\\\"modal_window\\\"></div>\");\n                $(\"#modal_window\").fadeIn(\"slow\");\n\n                // Centering content area.\n                centeringModalSyncer();\n                // Fade-in content area.\n                $(\"#modal_content\").fadeIn(\"slow\");\n                return true;\n            }\n\n            /**\n             * This is callback function whem cancel button is clicked.\n             * @param {string} url - URL of taget page.\n             */\n            function handleCancelClick(url) {\n                location.href = url;\n            }\n\n            /**\n             * This function add back button to modal window.\n             * @param {string} url - URL of target page.\n             */\n            function addBackButton(url) {\n                var contentHtml = \"<input type=button id=\\\"backToMymedia\\\" name=\\\"backToMymedia\\\" value=Back />\";\n                $(\"#modal_content\").append(contentHtml);\n                $(\"#backToMyMedia\").on(\"click\", function() {\n                    handleCancelClick(url);\n                });\n            }\n\n            /**\n             * This is callback function when access control setting is changed.\n             */\n            function selectedControl() {\n                require(['core/str', 'core/notification'], function(str, notification) {\n                    var strings = [\n                        {key: 'heading_access_control', component: 'local_yumymedia'},\n                        {key: 'accesscontrol_changed', component: 'local_yumymedia'}\n                    ];\n                    str.get_strings(strings).then(function(results) {\n                        var selectedControlId = $(\"#access_control_select\").val();\n                        var currentControlId = $(\"#currentcontrol\").val();\n\n                        var newLabel = results[0];\n\n                        if (selectedControlId != currentControlId) {\n                            newLabel = newLabel + \" <font color=\\\"red\\\">(\" + results[1] + \")</font>\";\n                            $(\"#access_media_save\").prop(\"disabled\", false);\n                        } else {\n                            $(\"#access_media_save\").prop(\"disabled\", true);\n                        }\n\n                        $(\"#access_control_label\").html(newLabel);\n                        return 0;\n                    }).fail(notification.exception);\n                });\n            }\n\n            /**\n             * This function update access control id.\n             */\n            function updateAccessControlId() {\n                var entryStatus;\n                var findData;\n\n                var controlId = $(\"#access_control_select\").val();\n                var entryId = $(\"#entryid\").val();\n                var serverHost = $(\"#kalturahost\").val();\n                var ks = $(\"#ks\").val();\n\n                // Create form data.\n                var fd = new FormData();\n                fd.append(\"action\", \"update\");\n                fd.append(\"ks\", ks);\n                fd.append(\"entryId\", entryId);\n                fd.append(\"baseEntry:accessControlId\", controlId);\n\n                // Create data is transmitted.\n                var postData = {\n                    type: \"POST\",\n                    data: fd,\n                    cache: false,\n                    async: true,\n                    contentType: false,\n                    scriptCharset: \"utf-8\",\n                    processData: false,\n                    dataType: \"xml\"\n                };\n\n                var serviceURL = serverHost + \"/api_v3/service/baseEntry/action/update\";\n\n                // Transmits data.\n                $.ajax(\n                   serviceURL, postData\n                )\n                .done(function(xmlData) {\n                    // When XML data is not received.\n                    if (xmlData === null || typeof xmlData === undefined) {\n                        printErrorMessage(\"Update failed (Cannot get a XML response)\");\n                        return;\n                    }\n\n                    // Get a tag of error code.\n                    findData = $(xmlData).find(\"code\");\n                    // When error code exists.\n                    if (findData !== null && typeof findData !== undefined && findData.text() !== \"\") {\n                        printErrorMessage(\"Update failed (\" + findData.text() + \")\");\n                        return;\n                    }\n\n                    // Get a tag of status.\n                    findData = $(xmlData).find(\"status\");\n                    // Where tag of statis not exists.\n                    if (findData === null || typeof findData === undefined || findData.text() === \"\") {\n                        printErrorMessage(\"Update failed (Cannot get a baseEntry)\");\n                        return;\n                    }\n\n                    // Get status value.\n                    entryStatus = findData.text();\n                    // When updating of access control is failed.\n                    if (entryStatus != STATUS.ENTRY_READY && entryStatus != STATUS.ENTRY_PENDING &&\n                        entryStatus != STATUS.ENTRY_PRECONVERT) {\n                        printErrorMessage(\"Update failed (status of baseEntry: \" + entryStatus + \")\");\n                        return;\n                    }\n\n                    // Get a tag of access control.\n                    findData = $(xmlData).find(\"accessControlId\");\n                    // When tag of acecss control not exists.\n                    if (findData === null || typeof findData === undefined || findData.text() === \"\") {\n                        printErrorMessage(\"Update failed(Cannot get an accessControlId)\");\n                        return;\n                    }\n\n                    // Get a value of access control.\n                    var resultId = findData.text();\n                    // When updating of access control is failed.\n                    if (resultId != controlId) {\n                        printErrorMessage(\"Update failed(accessControlId: \" + resultId + \")\");\n                        return;\n                    }\n\n                    // Print a success message.\n                    printSuccessMessage(resultId);\n                })\n                .fail(function(xmlData) {\n                    if (xmlData !== null) {\n                        window.console.dir(xmlData);\n                    }\n                    printErrorMessage(\"Update fialed(Cannot connect to contents server)\");\n                    return;\n                });\n            }\n\n            /**\n             * This function print a success message.\n             * @param {string} currentControl - Label of current access control.\n             */\n            function printSuccessMessage(currentControl) {\n                require(['core/str', 'core/notification'], function(str, notification) {\n                    var strings = [\n                        {key: 'accesscontrol_updated', component: 'local_yumymedia'}\n                    ];\n                    str.get_strings(strings).then(function(results) {\n                        var mymedia = $(\"#mymedia\").val();\n                        $(\"#access_media_save\").prop(\"disabled\", true);\n                        $(\"#currentcontrol\").val(currentControl);\n\n                        // View modal window.\n                        fadeInModalWindow();\n                        // Append message to content area.\n                        $(\"#modal_content\").append(\"<p>\" + results[0] + \"</p><br>\");\n                        // Append back button to content area.\n                        addBackButton(mymedia);\n                        // Close session to kaltura server.\n                        sessionEnd();\n                        // Jump tp my media page.\n                        setTimeout(function() {\n                            window.location.replace(mymedia);\n                        }, 1000);\n                        return 0;\n                    }).fail(notification.exception);\n                });\n            }\n\n            /**\n             * This function print error message.\n             * @param {string} message - message string.\n             */\n            function printErrorMessage(message) {\n                var mymedia = $(\"#mymedia\").val();\n\n                // Create error message.\n                message = \"<p><font color=red>\" + message + \"</font></p><br>\";\n                // View modal window.\n                fadeInModalWindow();\n                // Append error message to content area.\n                $(\"#modal_content\").append(message);\n                // Append back buttion to content area.\n                addBackButton(mymedia);\n                // Close session to kaltura server.\n                sessionEnd();\n            }\n\n            /**\n             * This function close a session between client and kaltura server.\n             */\n            function sessionEnd() {\n                var serverHost = $(\"#kalturahost\").val();\n                var serviceURL = serverHost + \"/api_v3/service/session/action/end\";\n\n                // Transmit from data.\n                $.ajax({\n                    type: \"GET\",\n                    url: serviceURL,\n                    cache: false\n                })\n                .done(function(xmlData) {\n                    // When format of response is not XML.\n                    if (xmlData !== null) {\n                        window.console.dir(xmlData);\n                    }\n                })\n                .fail(function(xmlData) {\n                    if (xmlData !== null) {\n                        window.console.dir(xmlData);\n                    }\n                });\n            }\n\n            /**\n             * This function print embed code for kaltura media.\n             */\n            function printHtmlCode() {\n                var selectedId = $(\"#code_type_select\").val();\n                var kalturaHost = $(\"#kalturahost\").val();\n                var partnerId = $(\"#partnerid\").val();\n                var uiconfId = $(\"#uiconfid\").val();\n                var entryId = $(\"#entryid\").val();\n                var now = Date.now();\n                var str = \"\";\n\n                if (selectedId == \"0\") {\n                    str = \"<iframe src=\\\"\" + kalturaHost + \"/p/\" + partnerId + \"/sp/\" + partnerId + \"00\";\n                    str += \"/embedIframeJs/uiconf_id/\" + uiconfId + \"/partner_id/\" + partnerId;\n                    str += \"?iframeembed=true&playerId=kaltura_player_\" + now;\n                    str += \"&entry_id=\" + entryId + \"\\\" width=\\\"560\\\" height=\\\"395\\\" \";\n                    str += \"allowfullscreen webkitallowfullscreen mozAllowFullScreen frameborder=\\\"0\\\" \";\n                    str += \"allow=\\\"encrypted-media\\\"></iframe>\";\n                } else {\n                    str = kalturaHost + \"/index.php/extwidget/preview/partner_id/\";\n                    str += partnerId + \"/uiconf_id/\" + uiconfId + \"/entry_id/\" + entryId + \"/embed/dynamic?\";\n                }\n                $(\"#codearea\").val(str);\n            }\n\n            // Entry unload event callback.\n            $(window).on(\"unload\", function() {\n                sessionEnd();\n            });\n\n            // If window is resize, call modal window centerize function.\n            $(window).resize(centeringModalSyncer);\n\n            // Entry change event callback.\n            $(\"#access_control_select\").on(\"change\", function() {\n                selectedControl();\n            });\n\n            // Entry change event callback.\n            $(\"#code_type_select\").on(\"change\", function() {\n                printHtmlCode();\n            });\n\n            // Entry click event callback.\n            $(\"#access_media_save\").on(\"click\", function() {\n                updateAccessControlId();\n            });\n\n            printHtmlCode();\n        }\n    };\n});\n"],"file":"accessrestriction.min.js"}